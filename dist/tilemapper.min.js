!function(t){function i(a){if(e[a])return e[a].exports;var n=e[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){!function(){var t=function(t){this.canvas=t.canvas,this.context=this.canvas.getContext("2d"),this.map=t.map,this.entities=t.entities||[],this.map.tilesets.forEach(function(i,e,a){var n=Math.floor(i.imagewidth/i.tilewidth)*Math.floor(i.imageheight/i.tileheight);a[e].image=t.images[e],a[e].min=i.firstgid-1,a[e].max=a[e].min+n,a[e].inside=function(t){return t>=this.min&&this.max>=t}.bind(i)}),this.tileLayers=this.map.layers.filter(function(t){return"tilelayer"===t.type}),this.imageLayers=this.map.layers.filter(function(t){return"imagelayer"===t.type}),this.tileLayers.forEach(function(t){t.data.forEach(function(t,i,e){e[i]=t-1})}),this.imageLayers.forEach(function(t,i,e){e[i].image=document.getElementById(t.image),e[i].context=this.context,e[i].getZIndex=function(t){return this.y+this.image.height+t}.bind(e[i]),e[i].draw=function(t,i){this.context.drawImage(this.image,this.x+t,this.y+i)}.bind(e[i])},this)};t.prototype.clip=function(t){var i=null;this.map.tilesets.forEach(function(e){e.inside(t)&&(i=e)});var e=Math.floor(t*i.tilewidth/i.imagewidth);return{image:i.image,x:t*i.tilewidth%i.imagewidth,y:e*i.tileheight%i.imageheight,width:i.tilewidth,height:i.tileheight}},t.prototype.draw=function(t,i){this.tileLayers.forEach(function(e){e.data.forEach(function(a,n){if(!(0>a)){var h=n%e.width,r=Math.floor(n/e.width),o=this.clip(a);this.context.drawImage(o.image,o.x,o.y,o.width,o.height,h*Map.tilewidth+t,r*Map.tileheight+i,Map.tilewidth,Map.tileheight)}},this)},this);var e=this.entities.concat(this.imageLayers);e.sort(function(t,e){return t.getZIndex(i)-e.getZIndex(i)}),e.forEach(function(e){e.draw(t,i)})},window.TileMap=t}()}]);